<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚˜ì˜ ì¡°ê° ì°¾ê¸° í”„ë¡œì íŠ¸: ìµœì¢… ì„±ì°°</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.development.min.js" crossorigin></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.development.min.js" crossorigin></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prop-types/15.8.1/prop-types.min.js" crossorigin></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.10.3/Recharts.min.js" crossorigin></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js" crossorigin></script>

    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        body { font-family: 'Pretendard', sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #9ca3af; }
        
        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 10%, 90% { transform: translateX(-4px); } 50% { transform: translateX(4px); } }
        .animate-shake { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }
        
        /* í”Œë ˆì´ìŠ¤í™€ë” ìŠ¤íƒ€ì¼ë§ (ë” íë¦¬ê²Œ) */
        ::placeholder { color: #9ca3af; opacity: 0.6; font-size: 0.95rem; }
    </style>
</head>
<body class="bg-indigo-50 text-gray-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { Radar, RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, ResponsiveContainer, Legend } = window.Recharts || {};

        // ìƒ‰ìƒ ë°ì´í„°
        const COLOR_PALETTE = [
            { name: "ì—´ì •ì˜ ë¹¨ê°•", value: "#ef4444", text: "text-red-500" },
            { name: "ì—ë„ˆì§€ ì£¼í™©", value: "#f97316", text: "text-orange-500" },
            { name: "ê¸ì •ì˜ ë…¸ë‘", value: "#eab308", text: "text-yellow-500" },
            { name: "ì‹±ê·¸ëŸ¬ìš´ ì—°ë‘", value: "#84cc16", text: "text-lime-500" },
            { name: "ì„±ì‹¤í•œ ì´ˆë¡", value: "#22c55e", text: "text-green-500" },
            { name: "ê°•ì¸í•œ ë¸”ë™", value: "#1f2937", text: "text-gray-900" }, 
            { name: "ììœ ë¡œìš´ í•˜ëŠ˜", value: "#0ea5e9", text: "text-sky-500" },
            { name: "ì§€í˜œë¡œìš´ íŒŒë‘", value: "#3b82f6", text: "text-blue-500" },
            { name: "ì‹ ë¹„í•œ ë‚¨ìƒ‰", value: "#6366f1", text: "text-indigo-500" },
            { name: "ì°½ì˜ì  ë³´ë¼", value: "#a855f7", text: "text-purple-500" },
            { name: "ë”°ëœ»í•œ ë¶„í™", value: "#ec4899", text: "text-pink-500" },
            { name: "ì°¨ë¶„í•œ íšŒìƒ‰", value: "#6b7280", text: "text-gray-500" }
        ];

        // ê³µí†µ ì§ˆë¬¸ ì»´í¬ë„ŒíŠ¸
        const QuestionStep = ({ icon, title, description, question, name, value, onChange, onNext, onBack, placeholder, step, isLast, color = "blue", children, isError }) => {
            const colorClasses = {
                purple: "text-purple-500 border-purple-200 ring-purple-200 bg-purple-50/50",
                green: "text-green-500 border-green-200 ring-green-200 bg-green-50/50",
                pink: "text-pink-500 border-pink-200 ring-pink-200 bg-pink-50/50",
                indigo: "text-indigo-500 border-indigo-200 ring-indigo-200 bg-indigo-50/50",
                yellow: "text-yellow-500 border-yellow-200 ring-yellow-200 bg-yellow-50/50",
                blue: "text-blue-500 border-blue-200 ring-blue-200 bg-blue-50/50"
            };
            const displayColorClass = colorClasses[color] || colorClasses.blue;

            return (
                <div className="flex flex-col h-full max-w-3xl mx-auto w-full animate-fade-in pb-10">
                    <div className="flex items-center gap-4 mb-6">
                        <div className={`bg-white p-4 rounded-2xl shadow-sm border border-gray-100 text-3xl`}>
                            {icon}
                        </div>
                        <div>
                            <h2 className="text-2xl font-bold text-gray-800">{title}</h2>
                            <p className="text-sm text-gray-500 mt-1 font-medium">ë‚˜ì˜ ìƒê°ì„ ììœ ë¡­ê²Œ ì ì–´ë³´ì„¸ìš”</p>
                        </div>
                    </div>

                    <div className="bg-white p-6 md:p-8 rounded-3xl shadow-lg border border-gray-100 mb-8 flex-1 flex flex-col">
                        <p className="text-gray-700 text-lg mb-6 leading-relaxed font-medium bg-gray-50 p-5 rounded-2xl border-l-4 border-gray-300 break-keep">
                            {description}
                        </p>

                        {children}

                        {question && (
                            <div className="flex-1 flex flex-col mt-4">
                                <label className="block text-gray-800 font-bold mb-4 text-xl leading-relaxed break-keep">
                                    {question.split('_______________').map((part, i, arr) => (
                                        <React.Fragment key={i}>
                                            {part}
                                            {i < arr.length - 1 && (
                                                <span className={`inline-block border-b-2 px-2 mx-1 min-w-[80px] text-center bg-gray-50 rounded-t`}>
                                                    (ë¹ˆì¹¸)
                                                </span>
                                            )}
                                        </React.Fragment>
                                    ))}
                                </label>
                                
                                <textarea
                                    name={name}
                                    value={value}
                                    onChange={onChange}
                                    placeholder={placeholder}
                                    className={`w-full p-6 border-2 rounded-2xl outline-none transition-all min-h-[150px] text-lg leading-loose shadow-inner resize-y ${displayColorClass.split(' ').slice(1).join(' ')} focus:ring-2 focus:ring-blue-400 focus:border-blue-400 placeholder-gray-400 ${isError && value.length === 0 ? 'border-red-500 ring-2 ring-red-200 animate-shake' : 'border-gray-200'}`}
                                ></textarea>
                                <p className={`text-right text-sm mt-3 font-medium flex justify-end items-center gap-1 ${isError && value.length === 0 ? 'text-red-500 font-bold' : 'text-gray-400'}`}>
                                    {isError && value.length === 0 ? 'âš ï¸ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!' : (value.length > 0 ? `âœ… ì‘ì„±ì¤‘... (${value.length}ì)` : 'ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”')}
                                </p>
                            </div>
                        )}
                    </div>

                    <div className="flex justify-between items-center mt-auto py-4 px-2">
                        <button type="button" onClick={onBack} className="px-6 py-3 text-gray-500 hover:text-gray-800 font-bold rounded-full hover:bg-gray-200 transition-colors flex items-center gap-2">ğŸ‘ˆ ì´ì „</button>
                        <button type="button" onClick={onNext} className={`px-10 py-3.5 rounded-full text-white font-bold shadow-lg shadow-gray-200 transition-all transform hover:-translate-y-1 active:scale-95 flex items-center gap-2 ${isLast ? 'bg-gray-900 hover:bg-black text-lg' : 'bg-blue-500 hover:bg-blue-600'}`}>{isLast ? 'ì™„ì„±í•˜ê¸° âœ¨' : 'ë‹¤ìŒ ğŸ‘‰'}</button>
                    </div>
                </div>
            );
        };

        const GrowthChart = ({ beforeData, afterData, showLegend = true, height = 300 }) => {
            if (!RadarChart) return <div className="text-red-500">ê·¸ë˜í”„ ë¡œë”© ì‹¤íŒ¨</div>; 
            const data = [
                { subject: 'ìì•„ì¡´ì¤‘ê°', A: beforeData.selfEsteem, B: afterData.selfEsteem, fullMark: 5 },
                { subject: 'ì¹œë°€ê°', A: beforeData.intimacy, B: afterData.intimacy, fullMark: 5 },
                { subject: 'ì†Œì†ê°', A: beforeData.belonging, B: afterData.belonging, fullMark: 5 },
                { subject: 'ê³µê° ëŠ¥ë ¥', A: beforeData.empathy, B: afterData.empathy, fullMark: 5 },
                { subject: 'í‘œí˜„ë ¥', A: beforeData.expression, B: afterData.expression, fullMark: 5 },
            ];
            return (
                <div style={{ width: '100%', height: height }}>
                    <ResponsiveContainer>
                        <RadarChart cx="50%" cy="50%" outerRadius="70%" data={data}>
                            <PolarGrid />
                            <PolarAngleAxis dataKey="subject" tick={{ fill: '#4b5563', fontSize: 12 }} />
                            <PolarRadiusAxis angle={30} domain={[0, 5]} tick={false} axisLine={false} />
                            <Radar name="í™œë™ ì „" dataKey="A" stroke="#fbbf24" fill="#fbbf24" fillOpacity={0.3} />
                            <Radar name="í™œë™ í›„" dataKey="B" stroke="#22c55e" fill="#22c55e" fillOpacity={0.4} />
                            {showLegend && <Legend />}
                        </RadarChart>
                    </ResponsiveContainer>
                </div>
            );
        };

        function App() {
            const [step, setStep] = useState(0); 
            const [formData, setFormData] = useState({
                grade: '5', classNum: '', name: '',
                selectedColor: '', selectedColorName: '', 
                pieceName: '', // â˜… ìƒˆë¡œ ì¶”ê°€ëœ ì¡°ê° ì´ë¦„ í•„ë“œ
                selfDiscovery: '', feeling: '', classChange: '', role: '', shout: '', worldChange: '', resolution: ''
            });
            const [graphData, setGraphData] = useState({
                before: { selfEsteem: 3, intimacy: 3, belonging: 3, empathy: 3, expression: 3 },
                after: { selfEsteem: 4, intimacy: 4, belonging: 4, empathy: 4, expression: 4 }
            });
            const [image, setImage] = useState(null);
            const [copied, setCopied] = useState(false);
            const [shakeInput, setShakeInput] = useState(false);
            const [isCapturing, setIsCapturing] = useState(false);
            const reportRef = useRef(null);

            useEffect(() => { window.scrollTo(0, 0); }, [step]);

            const validateStep = (currentStep) => {
                switch(currentStep) {
                    case 0: return formData.grade && formData.classNum && formData.name;
                    // â˜… 1ë‹¨ê³„ ê²€ì¦: ìƒ‰ìƒ ì„ íƒ, ì¡°ê° ì´ë¦„, ì„±ì°° ë‚´ìš© ëª¨ë‘ í™•ì¸
                    case 1: return formData.selfDiscovery.trim().length > 0 && formData.selectedColorName !== '' && formData.pieceName.trim().length > 0;
                    case 2: return formData.feeling.trim().length > 0 && formData.classChange.trim().length > 0;
                    case 3: return formData.role.trim().length > 0;
                    case 4: return formData.shout.trim().length > 0 && formData.worldChange.trim().length > 0;
                    case 5: return formData.resolution.trim().length > 0;
                    case 6: return true;
                    default: return true;
                }
            };

            const handleNext = () => {
                if (!validateStep(step)) { setShakeInput(true); setTimeout(() => setShakeInput(false), 500); return; }
                setStep((prev) => prev + 1);
            };
            const handleBack = () => setStep((prev) => prev - 1);
            const handleChange = (e) => setFormData((prev) => ({ ...prev, [e.target.name]: e.target.value }));
            
            const handleColorSelect = (color) => {
                setFormData((prev) => ({
                    ...prev,
                    selectedColor: color.value,
                    selectedColorName: color.name
                }));
            };

            const handleImageUpload = (e) => { const file = e.target.files[0]; if (file) { const reader = new FileReader(); reader.onloadend = () => setImage(reader.result); reader.readAsDataURL(file); } };
            const handleGraphChange = (type, key, value) => setGraphData(prev => ({ ...prev, [type]: { ...prev[type], [key]: parseInt(value) } }));

            const handleTestMode = () => {
                setFormData({
                    grade: '5', classNum: '1', name: 'ê¹€ì„±ì¥',
                    selectedColor: '#ef4444', selectedColorName: 'ì—´ì •ì˜ ë¹¨ê°•', pieceName: 'ì¦ê±°ìš´ ì—´ì •', // í…ŒìŠ¤íŠ¸ ë°ì´í„° ìˆ˜ì •
                    selfDiscovery: 'ëˆê¸° ìˆê²Œ ë…¸ë ¥í•˜ëŠ” ì‚¬ëŒ', feeling: 'ë¿Œë“¯', classChange: 'ì„œë¡œ ë•ëŠ” ë°˜ì´',
                    role: 'ì¹œêµ¬ë“¤ì˜ ì´ì•¼ê¸°ë¥¼ ë“¤ì–´ì£¼ëŠ”', shout: 'ë„ˆëŠ” í˜¼ìê°€ ì•„ë‹ˆì•¼!', worldChange: 'ë”°ëœ»í•œ ì„¸ìƒ',
                    resolution: 'ë§¤ì¼ ì¹œêµ¬ë“¤ì—ê²Œ ì¹­ì°¬ í•œë§ˆë””ì”© ê±´ë„¤ê² ìŠµë‹ˆë‹¤'
                });
                setStep(7);
            };

            const handleCaptureCopy = async () => {
                if (!reportRef.current) return;
                setIsCapturing(true);
                try {
                    const canvas = await html2canvas(reportRef.current, { scale: 2, useCORS: true, backgroundColor: "#ffffff" });
                    canvas.toBlob(async (blob) => {
                        try {
                            const data = [new ClipboardItem({ [blob.type]: blob })];
                            await navigator.clipboard.write(data);
                            setCopied(true);
                            setTimeout(() => setCopied(false), 2000);
                        } catch (err) { alert("ì´ë¯¸ì§€ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."); }
                        setIsCapturing(false);
                    });
                } catch (err) { alert("ìº¡ì²˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."); setIsCapturing(false); }
            };

            const renderContent = () => {
                switch (step) {
                    case 0:
                        return (
                            <div className="flex flex-col items-center justify-center min-h-[90vh] text-center p-6 space-y-6 animate-fade-in relative max-w-lg mx-auto">
                                <button type="button" onClick={handleTestMode} className="absolute top-0 right-0 m-2 text-xs bg-gray-100 text-gray-500 px-3 py-1 rounded-full hover:bg-gray-200">ğŸ§ª í…ŒìŠ¤íŠ¸</button>
                                <div className="space-y-4">
                                    <div className="bg-white p-6 rounded-full inline-block shadow-md mb-2"><div className="text-6xl animate-bounce">ğŸŒŸ</div></div>
                                    <h1 className="text-3xl font-bold text-gray-800 break-keep leading-tight">ë‚˜ì˜ ì¡°ê° ì°¾ê¸° í”„ë¡œì íŠ¸:<br /><span className="text-blue-600">ìµœì¢… ì„±ì°°</span></h1>
                                    <p className="text-gray-600 mb-4">ì§ˆë¬¸ì— ë‹µì„ í•˜ë©´ <strong>'ë‚˜ë§Œì˜ ì„±ì¥ ì´ì•¼ê¸°'</strong>ê°€ ì™„ì„±ë©ë‹ˆë‹¤!</p>
                                </div>
                                <div className={`bg-white p-6 rounded-2xl shadow-lg w-full border-2 transition-all ${shakeInput ? 'border-red-400 animate-shake' : 'border-blue-100'}`}>
                                    <h3 className="text-lg font-bold text-gray-700 mb-4 text-left flex items-center gap-2"><span>ğŸ“</span> ì´ë¦„ì„ ì ì–´ì£¼ì„¸ìš”</h3>
                                    <div className="flex gap-2 mb-4">
                                        <input type="number" name="grade" value={formData.grade} onChange={handleChange} className="w-1/3 p-3 bg-gray-50 border border-gray-200 rounded-xl text-center font-bold text-lg" />
                                        <input type="number" name="classNum" value={formData.classNum} onChange={handleChange} placeholder="ë°˜" className="w-1/3 p-3 bg-gray-50 border border-gray-200 rounded-xl text-center font-bold text-lg" />
                                        <input type="text" name="name" value={formData.name} onChange={handleChange} placeholder="ì´ë¦„" className="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl text-center font-bold text-lg" />
                                    </div>
                                    <div className="p-4 bg-indigo-50 rounded-xl border-2 border-dashed border-indigo-200 text-center"><label className="block cursor-pointer hover:bg-indigo-100 transition-colors rounded-lg p-2"><div className="flex flex-col items-center justify-center gap-2"><span className="text-3xl">ğŸ“¸</span><span className="text-indigo-700 font-bold">ë‚˜ì˜ ì¡°ê° ì‚¬ì§„ ì˜¬ë¦¬ê¸°</span></div><input type="file" accept="image/*" onChange={handleImageUpload} className="hidden" /></label>{image && <div className="mt-4 relative inline-block"><img src={image} className="h-40 object-contain rounded-lg shadow-md border border-white" /><button type="button" onClick={() => setImage(null)} className="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs">âœ•</button></div>}</div>
                                    {shakeInput && <p className="text-red-500 text-sm font-bold text-right mt-2">ë°˜ê³¼ ì´ë¦„ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”! ğŸ˜…</p>}
                                </div>
                                <button type="button" onClick={handleNext} className="w-full py-4 bg-blue-600 text-white rounded-xl text-xl font-bold shadow-lg hover:bg-blue-700 transition-all transform hover:-translate-y-1">ì‹œì‘í•˜ê¸° ğŸ‘‰</button>
                            </div>
                        );
                    
                    // â˜… 1ë‹¨ê³„ ìˆ˜ì •: ìƒ‰ê¹” ì„ íƒ, ì¡°ê° ì´ë¦„, ì„±ì°° ì§ˆë¬¸ ë³€ê²½
                    case 1:
                        return (
                            <QuestionStep icon="ğŸ“–" color="purple" title="1ë‹¨ê³„: ìê¸° ì´í•´" 
                                description="ë‚´ê°€ ë§Œë“  ì¡°ê°ì˜ ìƒ‰ê¹”ì€ ë¬´ì—‡ì¸ê°€ìš”?" 
                                question="ì €ëŠ” ë‚´ê°€ ë§Œë“  ì¡°ê°ì„ í†µí•´ ë‚˜ì˜ ë‚´ë©´ì„ íƒìƒ‰í•˜ê²Œ ë˜ì—ˆê³  ì œê°€ _______________ ë¼ëŠ” ê²ƒì„ ìƒˆë¡­ê²Œ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤." 
                                name="selfDiscovery" value={formData.selfDiscovery} onChange={handleChange} onNext={handleNext} onBack={handleBack} 
                                placeholder="ì˜ˆ: ëˆê¸° ìˆê²Œ ë¬´ì–¸ê°€ë¥¼ ë§Œë“œëŠ” ê²ƒì„ ì¢‹ì•„í•˜ëŠ” ì‚¬ëŒ" 
                                step={step} isError={shakeInput}
                            >
                                {/* ìƒ‰ê¹” ì„ íƒ */}
                                <div className={`mb-6 p-5 bg-white rounded-xl border-2 ${shakeInput && !formData.selectedColorName ? 'border-red-400 animate-shake' : 'border-gray-100'} shadow-sm`}>
                                    <label className="block text-gray-700 font-bold mb-3 flex items-center gap-2">ğŸ¨ ë‚˜ë¥¼ í‘œí˜„í•˜ëŠ” ìƒ‰ê¹”ì„ ê³¨ë¼ë³´ì„¸ìš”</label>
                                    <div className="grid grid-cols-4 sm:grid-cols-6 gap-3">
                                        {COLOR_PALETTE.map((c) => (
                                            <button key={c.value} type="button" onClick={() => handleColorSelect(c)} className={`w-full aspect-square rounded-full shadow-sm flex items-center justify-center transition-all transform hover:scale-110 ${formData.selectedColor === c.value ? 'ring-4 ring-offset-2 ring-purple-400 scale-110' : ''}`} style={{ backgroundColor: c.value }} title={c.name}>
                                                {formData.selectedColor === c.value && <span className="text-white text-lg drop-shadow-md">âœ”</span>}
                                            </button>
                                        ))}
                                    </div>
                                    {shakeInput && !formData.selectedColorName && <p className="text-red-500 text-sm mt-2 text-right font-bold">ìƒ‰ê¹”ë„ ê¼­ ì„ íƒí•´ì£¼ì„¸ìš”! ğŸ¨</p>}
                                </div>

                                {/* â˜… ìƒˆë¡œ ì¶”ê°€ëœ ì§ˆë¬¸: ì¡°ê° ì´ë¦„ */}
                                <div className="mb-6">
                                    <label className="block text-gray-800 font-bold mb-3 text-lg">ë‚˜ì˜ ì¡°ê°ì˜ ì´ë¦„ì€ ë¬´ì—‡ì¸ê°€ìš”?</label>
                                    <input 
                                        type="text" 
                                        name="pieceName" 
                                        value={formData.pieceName} 
                                        onChange={handleChange} 
                                        placeholder="ìš•êµ¬ ë‹¨ì–´ 1ê°œì™€ ê°ì • ë‹¨ì–´ 1ê°œë¥¼ ì—°ê²°í•´ì„œ ì´ë¦„ ì§“ìŠµë‹ˆë‹¤."
                                        className={`w-full p-4 border-2 rounded-xl outline-none text-lg focus:ring-2 focus:ring-purple-400 focus:border-purple-400 placeholder-gray-400 ${shakeInput && !formData.pieceName ? 'border-red-500 ring-2 ring-red-200 animate-shake' : 'border-gray-200'}`}
                                    />
                                    {shakeInput && !formData.pieceName && <p className="text-red-500 text-sm mt-1 text-right font-bold">ì´ë¦„ë„ ì§€ì–´ì£¼ì„¸ìš”!</p>}
                                </div>
                            </QuestionStep>
                        );

                    case 2:
                        return (
                            <div className="flex flex-col h-full max-w-3xl mx-auto w-full p-4 animate-fade-in pb-10">
                                <div className="flex items-center gap-3 mb-6"><div className="bg-pink-100 p-3 rounded-xl text-3xl">ğŸ’–</div><h2 className="text-2xl font-bold text-gray-800">2ë‹¨ê³„: ê´€ê³„</h2></div>
                                <div className="flex-1 flex flex-col space-y-8 overflow-y-auto pb-4 custom-scrollbar">
                                    <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all focus-within:ring-2 focus-within:ring-pink-200 flex flex-col"><label className="block text-gray-700 font-bold mb-3 text-lg">Q1. ì¹œêµ¬ë“¤ì—ê²Œ ê¸ì •ì ì¸ ëŒ“ê¸€ì„ ë‹¬ì•„ì£¼ì—ˆì„ ë•Œ, ì œ ë§ˆìŒì€ ì–´ë• ë‚˜ìš”?</label><textarea name="feeling" value={formData.feeling} onChange={handleChange} placeholder="ì˜ˆ: ë¿Œë“¯í•˜ê³  ë”°ëœ»" className="w-full p-4 border-2 rounded-xl outline-none transition-all min-h-[150px] resize-y text-lg bg-pink-50/30 leading-relaxed focus:border-pink-400 placeholder-gray-400"></textarea><p className="text-gray-400 text-sm mt-2 text-right">... í–ˆìŠµë‹ˆë‹¤.</p></div>
                                    <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all focus-within:ring-2 focus-within:ring-pink-200 flex flex-col"><label className="block text-gray-700 font-bold mb-3 text-lg">Q2. ì´ëŸ° í–‰ë™ë“¤ì´ ëª¨ì—¬ ìš°ë¦¬ ë°˜ì€ ì–´ë–»ê²Œ ë³€í• ê¹Œìš”?</label><textarea name="classChange" value={formData.classChange} onChange={handleChange} placeholder="ì˜ˆ: ì„œë¡œë¥¼ ë” ë¯¿ê³  ì‘ì›í•˜ëŠ” ì‚¬ì´ê°€" className="w-full p-4 border-2 rounded-xl outline-none transition-all min-h-[150px] resize-y text-lg bg-pink-50/30 leading-relaxed focus:border-pink-400 placeholder-gray-400"></textarea><p className="text-gray-400 text-sm mt-2 text-right">... ë˜ì—ˆìŠµë‹ˆë‹¤.</p></div>
                                    {shakeInput && <p className="text-center text-red-500 font-bold animate-shake">âš ï¸ ëª¨ë“  ì§ˆë¬¸ì— ë‹µì„ í•´ì£¼ì„¸ìš”!</p>}
                                </div>
                                <div className="flex justify-between items-center mt-auto py-4 px-2"><button type="button" onClick={handleBack} className="px-6 py-3 text-gray-500 font-bold rounded-full hover:bg-gray-200">ğŸ‘ˆ ì´ì „</button><button type="button" onClick={handleNext} className="px-10 py-3.5 rounded-full text-white font-bold bg-pink-500 hover:bg-pink-600 shadow-lg">ë‹¤ìŒ ğŸ‘‰</button></div>
                            </div>
                        );
                    case 3:
                        return <QuestionStep icon="ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" color="green" title="3ë‹¨ê³„: ê³µë™ì²´" description="ìš°ë¦¬ ë°˜ì´ë¼ëŠ” í° ê·¸ë¦¼ ì†ì—ì„œ, ë‚˜ì˜ ì¥ì ìœ¼ë¡œ ì¹œêµ¬ë“¤ì—ê²Œ ì–´ë–¤ ë„ì›€ì„ ì¤„ ìˆ˜ ìˆì„ê¹Œìš”?" question="ìš°ë¦¬ ë°˜ì´ í•˜ë‚˜ì˜ ë©‹ì§„ ì‘í’ˆì´ë¼ë©´, ì €ëŠ” ê·¸ ì•ˆì—ì„œ _______________ ì—­í• ì„ í•˜ì—¬ ì¹œêµ¬ë“¤ì—ê²Œ ë„ì›€ì„ ì£¼ê³  ì‹¶ìŠµë‹ˆë‹¤." name="role" value={formData.role} onChange={handleChange} onNext={handleNext} onBack={handleBack} placeholder="ì˜ˆ: ë¹„íƒ€ë¯¼ ê°™ì€, ë¬µë¬µíˆ ë•ëŠ”" step={step} isError={shakeInput} />;
                    case 4:
                        return (
                            <div className="flex flex-col h-full max-w-3xl mx-auto w-full p-4 animate-fade-in pb-10">
                                <div className="flex items-center gap-3 mb-6"><div className="bg-indigo-100 p-3 rounded-xl text-3xl">ğŸŒ</div><h2 className="text-2xl font-bold text-gray-800">4ë‹¨ê³„: ì„±ì¥ ì˜ì§€</h2></div>
                                <div className="flex-1 flex flex-col space-y-8 overflow-y-auto pb-4 custom-scrollbar">
                                    <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all focus-within:ring-2 focus-within:ring-indigo-200 flex flex-col"><label className="block text-gray-700 font-bold mb-3 text-lg">Q1. ë§Œì•½ ì œ ì¡°ê°ì´ ë§ì„ í•  ìˆ˜ ìˆë‹¤ë©´, ì„¸ìƒì— ë­ë¼ê³  ì™¸ì¹˜ê³  ì‹¶ë‚˜ìš”?</label><textarea name="shout" value={formData.shout} onChange={handleChange} placeholder="ì˜ˆ: ë„ˆëŠ” ê·¸ ìì²´ë¡œ ì†Œì¤‘í•´!" className="w-full p-4 border-2 rounded-xl outline-none transition-all min-h-[150px] resize-y text-lg bg-indigo-50/30 leading-relaxed focus:border-indigo-400 placeholder-gray-400"></textarea><p className="text-gray-400 text-sm mt-2 text-right">... ë¼ê³  ì™¸ì¹˜ê³  ì‹¶ìŠµë‹ˆë‹¤.</p></div>
                                    <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all focus-within:ring-2 focus-within:ring-indigo-200 flex flex-col"><label className="block text-gray-700 font-bold mb-3 text-lg">Q2. ê·¸ëŸ¬ë©´ ì„¸ìƒì€ ì–´ë–»ê²Œ ë°”ë€”ê¹Œìš”?</label><textarea name="worldChange" value={formData.worldChange} onChange={handleChange} placeholder="ì˜ˆ: ëª¨ë‘ê°€ ì›ƒìŒê½ƒì´ í”¼ëŠ” í‰í™”ë¡œìš´ ê³³" className="w-full p-4 border-2 rounded-xl outline-none transition-all min-h-[150px] resize-y text-lg bg-indigo-50/30 leading-relaxed focus:border-indigo-400 placeholder-gray-400"></textarea><p className="text-gray-400 text-sm mt-2 text-right">(ìƒê° ë„“íˆê¸°ìš© ì§ˆë¬¸ì…ë‹ˆë‹¤)</p></div>
                                    {shakeInput && <p className="text-center text-red-500 font-bold animate-shake">âš ï¸ ëª¨ë“  ì§ˆë¬¸ì— ë‹µì„ í•´ì£¼ì„¸ìš”!</p>}
                                </div>
                                <div className="flex justify-between items-center mt-auto py-4 px-2"><button type="button" onClick={handleBack} className="px-6 py-3 text-gray-500 font-bold rounded-full hover:bg-gray-200">ğŸ‘ˆ ì´ì „</button><button type="button" onClick={handleNext} className="px-10 py-3.5 rounded-full text-white font-bold bg-indigo-500 hover:bg-indigo-600 shadow-lg">ë‹¤ìŒ ğŸ‘‰</button></div>
                            </div>
                        );
                    case 5:
                        return <QuestionStep icon="â­" color="yellow" title="ë§ˆì§€ë§‰: ë‚˜ì˜ ë‹¤ì§" description="ë‚˜ì˜ ì‘ì€ ì¡°ê°ë„ í° í˜ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤." question="ì•ìœ¼ë¡œ ì €ëŠ” ì œê°€ ë°œê²¬í•œ ê¸ì •ì˜ í˜ì„ _______________ ." name="resolution" value={formData.resolution} onChange={handleChange} onNext={handleNext} onBack={handleBack} placeholder="ì˜ˆ: ì¹œêµ¬ê°€ í˜ë“¤ ë•Œ ê°€ì¥ ë¨¼ì € ë‹¬ë ¤ê°€ ìœ„ë¡œí•˜ê³ ..." step={step} isLast={true} isError={shakeInput} />;
                    case 6:
                        return (
                            <QuestionStep icon="ğŸ“Š" color="indigo" title="ë‚˜ì˜ ì„±ì¥ ê·¸ë˜í”„ ë§Œë“¤ê¸°" description="ì•„ë˜ ìŠ¬ë¼ì´ë”ë¥¼ ì›€ì§ì—¬ í™œë™ ì „ê³¼ í›„ì˜ ë³€í™”ë¥¼ ì²´í¬í•´ë³´ì„¸ìš”." step={step} onNext={handleNext} onBack={handleBack} isLast={true}>
                                <div className="mb-6 flex justify-center bg-white p-4 rounded-xl shadow-sm border border-gray-100"><GrowthChart beforeData={graphData.before} afterData={graphData.after} /></div>
                                <div className="space-y-6">{['selfEsteem:ìì•„ì¡´ì¤‘ê°', 'intimacy:ì¹œë°€ê°', 'belonging:ì†Œì†ê°', 'empathy:ê³µê° ëŠ¥ë ¥', 'expression:í‘œí˜„ë ¥'].map((item) => { const [key, label] = item.split(':'); return (
                                    <div key={key} className="bg-gray-50 p-4 rounded-xl"><div className="flex justify-between mb-2"><span className="font-bold text-gray-700">{label}</span></div><div className="flex flex-col gap-3"><div className="flex items-center gap-3"><span className="text-xs font-bold text-yellow-500 w-12">í™œë™ ì „</span><input type="range" min="1" max="5" value={graphData.before[key]} onChange={(e) => handleGraphChange('before', key, e.target.value)} className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-yellow-400" /><span className="text-sm font-bold w-4 text-center">{graphData.before[key]}</span></div><div className="flex items-center gap-3"><span className="text-xs font-bold text-green-500 w-12">í™œë™ í›„</span><input type="range" min="1" max="5" value={graphData.after[key]} onChange={(e) => handleGraphChange('after', key, e.target.value)} className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-green-500" /><span className="text-sm font-bold w-4 text-center">{graphData.after[key]}</span></div></div></div>
                                ); })}</div>
                            </QuestionStep>
                        );
                    case 7:
                        return (
                            <div className="flex flex-col h-full max-w-3xl mx-auto w-full p-4 animate-fade-in">
                                <div className="flex items-center justify-between mb-4 print:hidden">
                                    <h2 className="text-2xl font-bold text-gray-800">ğŸ“„ ìµœì¢… ì„±ì°° ë³´ê³ ì„œ</h2>
                                    <div className="flex gap-2"><button type="button" onClick={() => setStep(prev => prev - 1)} className="text-indigo-600 hover:text-indigo-800 flex items-center gap-1 text-sm bg-indigo-50 px-3 py-2 rounded-lg font-bold border border-indigo-200">âœï¸ ìˆ˜ì •í•˜ê¸°</button><button type="button" onClick={() => { setStep(0); setFormData({...formData, selfDiscovery: '', feeling: '', classChange: '', role: '', shout: '', worldChange: '', resolution: ''}); setImage(null); }} className="text-gray-500 hover:text-gray-700 flex items-center gap-1 text-sm bg-gray-100 px-3 py-2 rounded-lg font-bold">ğŸ”„ ì²˜ìŒìœ¼ë¡œ</button></div>
                                </div>
                                <div ref={reportRef} className="bg-white rounded-xl shadow-xl border border-gray-200 p-6 flex-1 overflow-y-auto custom-scrollbar relative mx-auto w-full max-w-2xl select-text">
                                    <div style={{textAlign: 'right', borderBottom: '2px solid #f3f4f6', paddingBottom: '10px', marginBottom: '10px', color: '#6b7280'}}><span style={{fontWeight: 'bold', color: '#1f2937'}}>{formData.grade}í•™ë…„ {formData.classNum}ë°˜</span> <span>ì´ë¦„: <strong style={{color: '#2563eb', textDecoration: 'underline'}}>{formData.name}</strong></span></div>
                                    <h1 style={{fontSize: '1.5rem', fontWeight: 'bold', textAlign: 'center', color: '#1f2937', marginBottom: '15px', borderBottom: '4px double #e5e7eb', paddingBottom: '10px'}}>ë‚˜ì˜ ì†Œì¤‘í•œ ì¡°ê°ì„ ì°¾ì•„ì„œ</h1>
                                    <div style={{display: 'flex', gap: '20px', marginBottom: '20px'}}>
                                        {image && <div style={{flex: 1, textAlign: 'center'}}><img src={image} style={{maxWidth: '100%', maxHeight: '160px', objectFit: 'contain', borderRadius: '0.5rem'}} /><p style={{fontSize: '0.75rem', color: '#9ca3af'}}>â–² ë‚˜ì˜ ì†Œì¤‘í•œ ì¡°ê°</p></div>}
                                        <div style={{flex: 1, textAlign: 'center', minWidth: '200px'}}><div className="transform scale-90 origin-top"><GrowthChart beforeData={graphData.before} afterData={graphData.after} showLegend={false} height={180} /></div><p style={{fontSize: '0.75rem', color: '#9ca3af'}}>â–² ë‚˜ì˜ ì„±ì¥ ê·¸ë˜í”„</p></div>
                                    </div>
                                    <div style={{fontSize: '0.95rem', lineHeight: '1.8', color: '#374151', display: 'flex', flexDirection: 'column', gap: '15px'}}>
                                        
                                        {/* â˜… Chapter 1 ìˆ˜ì • ì™„ë£Œ: ì´ë¦„, ìƒ‰ê¹”, ìƒˆë¡œìš´ ì„±ì°° ë‚´ìš© ë°˜ì˜ â˜… */}
                                        <section>
                                            <h3 style={{fontWeight: 'bold', color: '#2563eb', marginBottom: '4px'}}>Chapter 1. ë‚˜ë¥¼ ê¹¨ë‹«ë‹¤</h3>
                                            <p style={{background: '#eff6ff', padding: '12px', borderRadius: '8px', borderLeft: '4px solid #3b82f6'}}>
                                                ì €ëŠ” ì´ë²ˆ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ ì €ì˜ ì‘ì€ ì¡°ê°ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì œ ì¡°ê°ì˜ ìƒ‰ê¹”ì€ <strong style={{color: formData.selectedColor, backgroundColor: 'white', padding: '0 4px', border: '1px solid #ddd', borderRadius: '4px'}}>{formData.selectedColorName}</strong>ì´ë©° ì´ë¦„ì€ <span style={{fontWeight: 'bold', color: '#1e40af'}}>{formData.pieceName}</span>ì…ë‹ˆë‹¤. ë‚˜ë§Œì˜ ì¡°ê°ì„ ë§Œë“¤ë©° ì €ëŠ” <span style={{fontWeight: 'bold', color: '#1e40af'}}>{formData.selfDiscovery}</span>ë¼ëŠ” ìƒˆë¡œìš´ ì‚¬ì‹¤ì„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
                                            </p>
                                        </section>
                                        
                                        <section><h3 style={{fontWeight: 'bold', color: '#db2777', marginBottom: '4px'}}>Chapter 2. í•¨ê»˜í•˜ëŠ” ê¸°ì¨</h3><p style={{background: '#fdf2f8', padding: '12px', borderRadius: '8px', borderLeft: '4px solid #ec4899'}}>ì¹œêµ¬ë“¤ì˜ ì¡°ê°ì— ê¸ì •ì ì¸ ëŒ“ê¸€ì„ ë‹¬ì•„ì£¼ì—ˆì„ ë•Œ ì œ ë§ˆìŒì€ <span style={{fontWeight: 'bold', color: '#be185d'}}>{formData.feeling}</span>í–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ëŸ° í–‰ë™ë“¤ì´ ëª¨ì—¬ ìš°ë¦¬ ë°˜ì€ <span style={{fontWeight: 'bold', color: '#be185d'}}>{formData.classChange}</span>ë˜ì—ˆìŠµë‹ˆë‹¤.</p></section>
                                        <section><h3 style={{fontWeight: 'bold', color: '#16a34a', marginBottom: '4px'}}>Chapter 3. ì†Œì¤‘í•œ ì—­í• </h3><p style={{background: '#f0fdf4', padding: '12px', borderRadius: '8px', borderLeft: '4px solid #22c55e'}}>ìš°ë¦¬ë°˜ì´ í•˜ë‚˜ì˜ ë©‹ì§„ ì‘í’ˆì´ë¼ë©´ ì €ëŠ” ê·¸ ì•ˆì—ì„œ <span style={{fontWeight: 'bold', color: '#15803d'}}>{formData.role}</span> ì—­í• ì„ í•˜ì—¬ ì¹œêµ¬ë“¤ì—ê²Œ ë„ì›€ì„ ì£¼ê³  ì‹¶ìŠµë‹ˆë‹¤.</p></section>
                                        <section><h3 style={{fontWeight: 'bold', color: '#4f46e5', marginBottom: '4px'}}>Chapter 4. ì„¸ìƒì— ì™¸ì¹˜ëŠ” í•œë§ˆë””</h3><p style={{background: '#eef2ff', padding: '12px', borderRadius: '8px', borderLeft: '4px solid #6366f1'}}>ë§Œì•½, ì œ ì¡°ê°ì´ ì˜¨ ì„¸ìƒì— ë§ì„ í•  ìˆ˜ ìˆë‹¤ë©´ ì €ëŠ” í°ì†Œë¦¬ë¡œ "<span style={{fontWeight: 'bold', color: '#4338ca'}}>{formData.shout}</span>"ë¼ê³  ì™¸ì¹˜ê³  ì‹¶ìŠµë‹ˆë‹¤.</p></section>
                                        <section><h3 style={{fontWeight: 'bold', color: '#ca8a04', marginBottom: '4px'}}>Chapter 5. ë‚˜ì˜ ë‹¤ì§</h3><p style={{background: '#fefce8', padding: '12px', borderRadius: '8px', borderLeft: '4px solid #eab308'}}>ì´ í™œë™ì„ í†µí•´ ì €ëŠ” ë‚˜ì˜ ì‘ì€ ì¡°ê°ë„ í° í˜ì„ ê°€ì§€ê³  ìˆë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹«ìŠµë‹ˆë‹¤. ì•ìœ¼ë¡œ ì €ëŠ” ì œê°€ ë°œê²¬í•œ ê¸ì •ì˜ í˜ì„ <span style={{fontWeight: 'bold', color: '#a16207'}}>{formData.resolution}</span>.</p></section>
                                    </div>
                                    <div style={{marginTop: '24px', paddingTop: '12px', borderTop: '1px solid #e5e7eb', textAlign: 'center', color: '#9ca3af', fontSize: '0.8rem'}}>âœ¨ My Wonderful Growth Story âœ¨</div>
                                </div>
                                <div className="mt-6 flex justify-center print:hidden"><button type="button" onClick={handleCaptureCopy} disabled={isCapturing} className={`px-8 py-4 rounded-full font-bold text-lg shadow-xl ${copied ? 'bg-green-500 text-white' : 'bg-gray-900 text-white'}`}>{isCapturing ? 'ğŸ“¸ ìº¡ì²˜ ì¤‘...' : (copied ? 'âœ… ë³µì‚¬ ì™„ë£Œ!' : 'ğŸ“‹ ì´ë¯¸ì§€ë¡œ ì „ì²´ ë³µì‚¬í•˜ê¸°')}</button></div>
                            </div>
                        );
                    default: return null;
                }
            };
            return (
                <div className="min-h-screen flex flex-col">
                    <header className="bg-white border-b border-gray-200 p-4 sticky top-0 z-10 shadow-sm"><div className="max-w-4xl mx-auto flex items-center gap-2 text-blue-600 font-bold"><span>âœ¨ Growth Project</span>{step >= 1 && step <= 5 && <span className="text-gray-400 text-sm font-normal">Step {step}/5</span>}</div></header>
                    {step >= 1 && step <= 5 && <div className="w-full h-1.5 bg-gray-200 sticky top-[61px] z-10"><div className="h-full bg-blue-500 transition-all duration-500" style={{ width: `${(step / 5) * 100}%` }}></div></div>}
                    <main className="flex-1 w-full max-w-4xl mx-auto flex flex-col p-4 md:p-6 pb-12">{renderContent()}</main>
                </div>
            );
        }
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
